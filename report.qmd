---
title: "The Enigmatic Coastal Taipan: Australia's Deadly Serpent üêç"
author: "Aishwarya Anil Kumar, Arindom Baruah"
format: html
bibliography: references.bib
number-sections: true
execute: 
  warning: false
  message: false
---


## Introduction {#sec-ref1}

The Taipan class of reptiles are indigenous to the land mass of Australia as well as Papua New Guinea, and are considered to be one of the deadliest snakes on the planet. The Taipan, scientifically known as the Oxyuranus genus, comprises several species, with the Coastal Taipan (Oxyuranus scutellatus) and the Inland Taipan (Oxyuranus microlepidotus) being the most renowned. These reptiles are highly venomous and belong to the elapid family, which includes other infamous snakes like the king cobra and the black mamba. According to @markwell2016killer, what sets the taipan apart, however, is its reputation as having the __most toxic venom of any snake in the world !__

In our current analysis, we will be focusing on the occurrences of Coastal Taipan across the various states of Australia. The coastal Taipan which has been scientifically named as Oxyuranus scutellatus, is commonly found in the northern regions of Australia and is renowned for its agility and speed. It primarily feeds on small mammals, birds, and occasionally reptiles, using its potent venom to immobilize its prey swiftly. 

![The coastal taipan (Oxyuranus scutellatus)](taipan.jpg){#fig-taipan}

Characterized by its slender body, shiny scales, and formidable fangs, the Taipan is a formidable predator. Despite its fearsome reputation, these snakes are generally reclusive and rarely encountered by humans. They prefer to inhabit coastal regions, woodlands, and savannas, blending seamlessly into their natural surroundings as can be observed in @fig-taipan.

While the Coastal Taipans are not classified as endangered species, however, with rapid human activities such as urbanisation and encroachment of wildlife area for agricultural purposes, the habitat of these reptiles have been increasingly affected as a result of which, steps have been taken by wild life conservationists to preserve their natural habitats to the best extent possible.



:::{.callout-note}
# Key assumptions

Based on the literature surveys for the Coastal Taipan, here are our assumptions while moving forward with our analysis:


1. Based on the information from the [Australia Museum](https://australian.museum/learn/animals/reptiles/coastal-taipan/), the Coastal Taipans are __active throughout the year__ but are observed to be most __commonly encountered during late winter to spring (August to December of a calendar year)__.
2. As can be inferred from its colloquial name, the Coastal Taipans are often observed __in the coastal regions of Australia.__ 
3. Based on a study by [Billabong Sanctuary](https://www.billabongsanctuary.com.au/coastal-taipan/#:~:text=Coastal%20taipans%20are%20common%20in,animals%20like%20rats%20and%20mice.), the Coastal Taipans are __not endangered and have probably increased in numbers__ due to the growth in the number of rats (who are the primary prey) in areas close to the human settlements.
4. The Coastal Taipans __thrive in the areas of monsoon wetlands and savannas with a humid weather__.
5. Coastal Taipans depend primarily on their venom as their defensive mechanism and consider human interactions as an act of aggression. Consequently, the number of sightings across Australia can be __considered to be limited to certain regions and in small numbers__.  
:::

Although we will attempt to accurately analyse the data by obtaining it from reliable repositories, however, it is important to consider the limitations of the dataset while making critical conclusions based on the data in hand. Some of the limitations of the current dataset are delineated as follows:

:::{.callout-warning}
# Limitations of the data

1. Since the data which has been obtained from the [Atlast of Living Australia](https://www.ala.org.au) falls under the category of __observational data__, there could be instances of missing values. These instances will need to be filtered out while analysing the data from the repository.

2. Since the data is obtained from various sources, there could be inconsistencies in reporting the data.

3. While the data collection was done in an extensive and granular manner, there could be a lack of precision of the observations made for the exact latitude and longitude.

4. The dataset obtained from the Atlas of Living Australia __only reports for all the Coastal Taipans that have been sighted and recorded__. Hence, it does not report the entire population of these reptiles across the various regions of Australia. This may lead to inaccurate conclusions post analysis of the limited data in hand.


5. The dataset here consist of __observational data__ and in particular, occurrences data. Some of the limitations that are prevalent in such datasets are as follows :
     - The data here is obtained from various sources. As a result, there may be __non-uniformity in the data provided__. Each reporting authority may have their own interpretations of the data they may have provided.
     - The current dataset obtained is a subset of an observational data. These types of data are often plagued with lack of randomisation during the selection of        data. This may lead to biases in the dataset such as selection and systematic bias.
     - The data maybe misclassified or filled in non-uniform units by the various sources, leading to lack of accuracy of the overall dataset.

:::

## Data description

<!--
2. Download all the occurrence records from the Atlas of Living Australia, ideally scripted using the `atlas_occurrences()` function from the `galah` package. Make sure you include date, time, collector identification details. Save this into a `data-raw` folder in your repo.
-->
```{r echo=FALSE}
library(galah)
library(tidyverse)
library(visdat)
library(ggplot2)
library(ggplot2)
library(ggmap)
library(maps)
library(leaflet)
library(ggpubr)
library(ggthemes)
```


```{r include=FALSE}

galah_config(email = "aani0005@student.monash.edu",
             download_reason_id = 10, 
             verbose = TRUE)
taipan <- atlas_occurrences(
  identify = galah_identify("Oxyuranus scutellatus scutellatus"),
  select = galah_select(group = c("basic","event")))
save(taipan, file=here::here("data-raw/taipan_raw.rda"))
```

```{r}
glimpse(taipan)
```

### Description of the Variables in the Dataset

The dataset contains data on observations of the Coastal Taipans (*Oxyuranus scutellatus scutellatus*) in Australia. The dataset has been organized into a tidy format. Below is a detailed description of each salient variable:

| Variable Name    | Data Type | Description |
|------------------|-----------|-------------|
| Latitude         | dbl       | The latitude coordinate of the observation location. |
| Longitude        | dbl       | The longitude coordinate of the observation location. |
| eventDate        | date      | The date when the observation was made. |
| scientificName   | chr       | The scientific name of the observed species. In this dataset, it's *Oxyuranus scutellatus scutellatus*. |
| taxonConceptID   | chr       | A unique URL that provides information about the taxonomic concept for the species. |
| recordID         | chr       | A unique identifier for each observation record. |
| dataResourceName | chr       | The name of the data resource/provider. |
| occurrenceStatus | chr       | The status of the observation, indicating if the species is present or absent at the location. |
| eventRemarks     | chr       | Special remarks related to the event sighting. |
| eventTime        | datetime  | Time of the event sighting. |
| eventID          | chr       | A unique ID for each event observation. |


## Initial data analysis

### Data Source 

**Data Source:** The data was sourced from the [Atlas of Living Australia (ALA)](https://www.ala.org.au/) using the `galah` R package.

### Data Cleaning

**Data Cleaning Steps:**

1. The datatype for `eventDate` has been changed to datetime for accurate temporal analysis. \
2. Observations with missing event dates, longitude, or latitude were filtered out.
3. Redundant variables were dropped from the dataset to keep only the salient variables important for the current analysis.


**Methods to Check and Clean Data:**

- **Validity Checks:** Ensure that the latitude and longitude values are within valid ranges. For latitude (-90 to 90) and for longitude (-180 to 180).
- **Consistency Checks:** Make sure there aren't any discrepancies in the way data is represented across rows.
- **Missing Value Analysis:** Any missing values should be analyzed to understand the reason behind them.
- **Outlier Analysis:** Especially for numeric fields like latitude and longitude, outlier detection can help spot any unusual or erroneous data points.
- **Date Consistency:** Ensure that the event dates fall within expected ranges and are formatted correctly.





<!--
3. Perform a data quality check, and then go ahead and clean the data, saving only the wild sightings. Save the resulting data in a `data` folder as an `WILD_THING_COMMON_NAME.rda` file, so that any special variable types are clearly available. (Replace `WILD_THING_COMMON_NAME` with lower case common name of your assigned wild thing.) *Note:* Some are museum or historical records or live in an animal sanctuary or zoo, which do not truly capture their wild behaviour. Downloading the event information (`galah_select(group = "event")`) can help identify wild sightings.

Weather data pre-processing here too.
-->
### Data Quality Check

```{r}
#| label: fig-vismiss
#| fig-cap: "Representation of missing values in the dataset"
vis_miss(taipan)
```
The `vis_miss()` function from the "visdat" package provides a visual representation of missing data in the dataset.

The plot illustrated in @fig-vismiss indicates __that about half of the total dataset has missing values__. These missing values can be observed majorly in the variables of eventRemarks,eventTime and eventID. In order to improve the quality of the overall data, we will consider either transforming these variables or removing them as a part of feature selection in the following sections.

### Data transformation and feature selection

As we are primarily interested in analysing the wild sightings of the Coastal Taipans across Australia, hence, we will filter out the data obtained from museums and animal sanctuaries. This information has been provided in the `event ID` column which will be used to filter the required data as shown in the code chunk below. It has been additionally assumed that the occurrences with no mention of the term "museum" have been considered as wild sightings in the context of the current study. 

```{r}
#| label: fig-dist
#| fig-cap: "Distribution of Coastal Taipan sightings in Australia"
taipan <- taipan %>% mutate(occurrence = if_else(str_detect(taipan$eventID,"museum"),"Museum","Wild"))
taipan$occurrence <- replace_na(taipan$occurrence,"Wild")

taipan_occurrs <- taipan %>% group_by(occurrence) %>% summarise(Count =  n())  

ggplot(taipan_occurrs, aes(x = occurrence,y = Count)) +
  geom_col(aes(fill = occurrence)) +
  labs(title = "Distribution of Coastal Taipan sightings",
       x = "Occurrence Type",
       y = "Number of sightings") +
  theme_classic() +
  theme(legend.position = "none") + geom_label(aes(label =Count))

```

Figure @fig-dist displays the distribution of Taipan sightings categorized into two types: Museum and Wild. It's evident from the figure that a portion of the data is sourced from museums, which means these observations don't represent the natural behavior or occurrence of Taipans in their wild habitats.

For a comprehensive study of the natural behavior or occurrence patterns of Taipans, it's pertinent to focus solely on the "Wild" type data.

```{r}
 # Selecting only wild occurrences of Coastal Taipans
taipan_wild <- taipan %>% filter(occurrence =="Wild")
```

We have observed a total of __`r taipan %>% nrow()` occurrences across Australia__. However, this number has been obtained from the raw data which __will need to be cleaned further__.

<div class="alert alert-block alert-warning">
Based on the initial data analysis, we will need to perform the following data cleaning operations:

1. Filter the data with valid sighting date for detailed temporal analysis.
2. Filter the data with valid values of longitude and latitude for detailed spatial analysis.
</div>

```{r}
taipan <- taipan %>% 
  rename(Longitude = decimalLongitude,
         Latitude = decimalLatitude) %>%
  mutate(eventDate = as.Date(eventDate)) %>%
  filter(!is.na(eventDate)) %>%
  filter(!is.na(Longitude)) %>%
  filter(!is.na(Latitude)) %>% select(-c("samplingEffort","samplingProtocol","taxonConceptID","recordID","dataResourceName"))
save(taipan, file=here::here("data/taipan.rda"))

```

<div class="alert alert-block alert-success">
‚ÄºÔ∏èüí°
Upon performing the required data cleaning operation, we have a total of __`r taipan %>% nrow()` wild sightings of Coastal Taipans across Australia__.
üí°‚ÄºÔ∏è
</div>


## Exploratory data analysis

<!--
4. Make plots of the data to check each of your expectations, and report what you learn. *Note:* This might also be a place where visual inference methods *may* be useful to determine if what is seen agrees or disputes what you expected. 

Weather data exploration here too.
-->


### When are the Coastal Taipans most likely to be observed ?

```{r}
#| label: fig-sightnum
#| fig-cap: "Monthly number of Coastal Taipan sightings in Australia"
taipan_grouped <- taipan %>% group_by(month(eventDate,label=TRUE)) %>% summarise(sightings = n())

taipan_grouped <- taipan_grouped %>% rename("month" = `month(eventDate, label = TRUE)`)



ggdotchart(taipan_grouped, y = "sightings", 
           x = "month",
           color = "sightings",                       
           add = "segments",
           add.params = list(color = "lightgray", size = 2),                             
           dot.size = 8,
           rotate=FALSE,
           label = "sightings",
           group = "month",                                
           font.label = list(color = "white", size = 8, 
                             vjust = 0, face = 'bold'),               
           ggtheme = theme_economist()                        
           ) + theme(legend.position = "none",panel.background = element_rect(fill = 'cornsilk'),axis.text = element_text(face = "bold"),axis.text.x = element_text(angle=45,vjust = 1)) +
  geom_hline(yintercept = 0, linetype = 2, color = "lightgray") + labs(y = "Number of sightings", 
                                                                       x= "Month of sighting",
                                                                       caption = "Source: ALA") + ggtitle("Total number of \n Coastal Taipan sightings in Australia") 
```
<div class="alert alert-block alert-warning">

üí°
@fig-sightnum illustrates the number of Coastal Taipans reported till date for each month. We can observe that the sightings are __higher between the months of July to December__ when compared to the rest of the year. This can be a result of the prevailing monsoon conditions in Australia which closely corroborates with our assumption stated in @sec-ref1.

Some of the reasons why the Coastal Taipans are observed to be more active are as follows:

1. __Breeding season__: The Coastal Taipans are highly active during the breeding season which closely conincides with the monsoon season in Australia.
2. __Increased prey availability__: The monsoon season in northern Australia typically brings heavy rainfall, which can lead to flooding in some areas. This flooding forces small mammals, reptiles, and other prey animals out of their burrows and hiding places, making them more accessible to Coastal Taipans. The increased prey availability during the monsoon can lead to an uptick in snake activity as they take advantage of the abundance of food.
3. __Temperature and humidity__: Reptiles are ectothermic in nature, meaning their body temperature is highly influenced by the environmental temperature. Monsoon season generally brings about warm and humid conditions. These conditions additionally improve the metabolism and mobility in reptiles which allows for higher activity and increased number of Coastal Taipan sightings.
4. __Migratory behaviour__: Due to increased mobility in the reptiles during the monsoon season, some Coastal Taipans exhibit migrate behaviour for better conditions and availability of prey. Migrations can often lead to human interactions and hence, their consequent sightings.

üí°
</div>








```{r}
australia_map <- map_data("world", region = "Australia")
ggplot() + 
  geom_polygon(data = australia_map, aes(x = long, y = lat, group = group), fill = "white", color = "black") +
  geom_point(data = taipan, aes(x = Longitude, y = Latitude), color = "red") +
  labs(title = "Animal Sightings in Australia") +
  coord_fixed(1.3, xlim = c(110, 155), ylim = c(-45, -10))

```

```{r}
# Assuming your dataset is named `sightings` and has columns `latitude` and `longitude`
leaflet(data = taipan) %>%
  addTiles() %>%
  addCircles(lng = ~Longitude, lat = ~Latitude, popup = paste("Scientific name:",taipan$scientificName, "<br>",
                                                              "Latitude:",taipan$Latitude,"<br>",
                                                              "Longitude:",taipan$Longitude,"<br>"), radius = 50, color = "red")

```





## Summary 

## Citations:

1. **Atlas of Living Australia (ALA)** - https://www.ala.org.au/
2. **The [galah](https://galah.ala.org.au) package** - Westgate M, Kellie D, Stevenson M, Newman P (2023). _galah: Biodiversity Data from the Living Atlas Community_. R package version 1.5.3,
  <https://CRAN.R-project.org/package=galah>.
3. __Tidyverse__ - Wickham H, Averick M, Bryan J, Chang W, McGowan LD, Fran√ßois R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM,
  M√ºller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). ‚ÄúWelcome to the tidyverse.‚Äù _Journal of
  Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 <https://doi.org/10.21105/joss.01686>.
4. __ggplot2__ - H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.

By exploring this data, researchers and enthusiasts can gain insights into the behavior, distribution, and occurrence patterns of the Coastal Taipan Snake, which can be useful for a range of ecological, environmental, and conservation studies.


## References
